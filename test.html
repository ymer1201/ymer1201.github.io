<!DOCTYPE html>
<html>
<head>
    <title>Python –≤ –±—Ä–∞—É–∑–µ—Ä–µ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
        }
        #code {
            width: 100%;
            height: 200px;
            padding: 10px;
            font-family: monospace;
        }
        button {
            padding: 10px 20px;
            background: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            margin: 10px 0;
        }
        #output {
            background: #f0f0f0;
            padding: 10px;
            white-space: pre-wrap;
        }
        .error {
            color: red;
        }
    </style>
</head>
<body>
    <h1>–ó–∞–ø—É—Å—Ç–∏—Ç–µ Python-–∫–æ–¥ –≤ –±—Ä–∞—É–∑–µ—Ä–µ üêç</h1>
    <textarea id="code" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ Python...">
import time
while True:
    print("–†–∞–±–æ—Ç–∞—é...")
    time.sleep(1)
    </textarea>
    <br>
    <button onclick="runPython()">–í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–¥</button>
    <button onclick="stopPython()" style="background: #f44336;">–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–¥</button>
    <h3>–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫:</h3>
    <input type="text" id="library" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏...">
    <button onclick="installLibrary()">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É</button>
    <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç:</h3>
    <div id="output"></div>

    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Pyodide -->
    <script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Pyodide
        let pyodide;
        let isRunning = false; // –§–ª–∞–≥ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞

        async function initializePyodide() {
            pyodide = await loadPyodide({
                indexURL: "https://cdn.jsdelivr.net/pyodide/v0.23.4/full/"
            });
            console.log("Pyodide –∑–∞–≥—Ä—É–∂–µ–Ω!");
        }

        // –ó–∞–ø—É—Å–∫ Python-–∫–æ–¥–∞
        async function runPython() {
            if (isRunning) {
                alert("–ö–æ–¥ —É–∂–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è!");
                return;
            }
            isRunning = true;
            let code = document.getElementById("code").value;
            let output = document.getElementById("output");

            try {
                // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –≤—ã–≤–æ–¥ Python –≤ –±—Ä–∞—É–∑–µ—Ä
                pyodide.runPython(`
                    import sys
                    from js import console
                    sys.stdout = sys.stderr = console
                `);

                // –í—ã–ø–æ–ª–Ω—è–µ–º –∫–æ–¥ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ
                setTimeout(async () => {
                    try {
                        await pyodide.runPythonAsync(code);
                        output.innerText = "‚úÖ –ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω!";
                    } catch (e) {
                        output.innerText = "üö® –û—à–∏–±–∫–∞:\n" + e.message;
                    } finally {
                        isRunning = false;
                    }
                }, 0);
            } catch (e) {
                output.innerText = "üö® –û—à–∏–±–∫–∞:\n" + e.message;
                isRunning = false;
            }
        }

        // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞
        function stopPython() {
            if (!isRunning) {
                alert("–ù–µ—Ç –≤—ã–ø–æ–ª–Ω—è—é—â–µ–≥–æ—Å—è –∫–æ–¥–∞!");
                return;
            }
            isRunning = false;
            location.reload(); // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–æ–¥–∞
            console.log("–ö–æ–¥ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!");
        }

        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫
        async function installLibrary() {
            let library = document.getElementById("library").value;
            if (!library) {
                alert("–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏!");
                return;
            }
            let output = document.getElementById("output");
            output.innerText = `‚è≥ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É ${library}...`;

            try {
                await pyodide.loadPackage("micropip");
                await pyodide.runPythonAsync(`
                    import micropip
                    micropip.install("${library}")
                `);
                output.innerText = `‚úÖ –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ ${library} —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞!`;
            } catch (e) {
                output.innerText = `üö® –û—à–∏–±–∫–∞ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ ${library}:\n${e.message}`;
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Pyodide –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        initializePyodide();
    </script>
</body>
</html>